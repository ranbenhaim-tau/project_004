{% extends "base.html" %}
{% block content %}

<div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2 mb-3">
  <div>
    <h2 class="mb-1">Manager Dashboard</h2>
    <div class="text-muted">Control flights, crew, and reports.</div>
  </div>
  <a class="btn btn-outline-secondary" href="{{ url_for('logout') }}"><i class="bi bi-box-arrow-right me-1"></i>Logout</a>
</div>

<div class="row g-3">
  <div class="col-md-3">
    <a class="text-decoration-none card-link-tile" href="{{ url_for('manager_flights') }}">
    <div class="card h-100 soft">
      <div class="card-body">
        <div class="d-flex align-items-center justify-content-between">
          <div>
            <div class="text-muted small">Flights</div>
            <div class="fs-3 fw-bold">{{stats.flights}}</div>
          </div>
          <i class="bi bi-airplane fs-2"></i>
        </div>
      </div>
    </div>
    </a>
  </div>
  <div class="col-md-3">
    <a class="text-decoration-none card-link-tile" href="{{ url_for('manager_orders') }}">
    <div class="card h-100 soft">
      <div class="card-body">
        <div class="d-flex align-items-center justify-content-between">
          <div>
            <div class="text-muted small">Orders</div>
            <div class="fs-3 fw-bold">{{stats.orders}}</div>
          </div>
          <i class="bi bi-receipt fs-2"></i>
        </div>
      </div>
    </div>
    </a>
  </div>
  <div class="col-md-3">
    <a class="text-decoration-none card-link-tile" href="{{ url_for('manager_aircrew') }}">
    <div class="card h-100 soft">
      <div class="card-body">
        <div class="d-flex align-items-center justify-content-between">
          <div>
            <div class="text-muted small">Crew</div>
            <div class="fs-3 fw-bold">{{stats.aircrew}}</div>
          </div>
          <i class="bi bi-people fs-2"></i>
        </div>
      </div>
    </div>
    </a>
  </div>
  <div class="col-md-3">
    <a class="text-decoration-none card-link-tile" href="{{ url_for('manager_aircraft') }}">
    <div class="card h-100 soft">
      <div class="card-body">
        <div class="d-flex align-items-center justify-content-between">
          <div>
            <div class="text-muted small">Aircraft</div>
            <div class="fs-3 fw-bold">{{stats.airplanes}}</div>
          </div>
          <i class="bi bi-building fs-2"></i>
        </div>
      </div>
    </div>
    </a>
  </div>
</div>


<div class="row g-3 mt-1">
  <div class="col-12">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <span>Executive reports</span>
      </div>
      <div class="card-body">
        <div class="row g-3">

          <div class="col-md-3">
            <a class="text-decoration-none card-link-tile" href="{{ url_for('manager_report_page', rid=2) }}">
              <div class="card h-100 soft">
                <div class="card-body">
                  <div class="d-flex align-items-center justify-content-between">
                    <div>
                      <div class="text-muted small">Revenue breakdown</div>
                      <div class="fw-bold">By size / manufacturer / class</div>
                      <div class="text-muted small mt-1">Click to open report</div>
                    </div>
                    <i class="bi bi-cash-coin fs-2"></i>
                  </div>
                </div>
              </div>
            </a>
          </div>

          <div class="col-md-3">
            <a class="text-decoration-none card-link-tile" href="{{ url_for('manager_report_page', rid=3) }}">
              <div class="card h-100 soft">
                <div class="card-body">
                  <div class="d-flex align-items-center justify-content-between">
                    <div>
                      <div class="text-muted small">Aircrew workload</div>
                      <div class="fw-bold">Flight hours (long/short)</div>
                      <div class="text-muted small mt-1">Click to open report</div>
                    </div>
                    <i class="bi bi-people fs-2"></i>
                  </div>
                </div>
              </div>
            </a>
          </div>

          <div class="col-md-3">
            <a class="text-decoration-none card-link-tile" href="{{ url_for('manager_report_page', rid=4) }}">
              <div class="card h-100 soft">
                <div class="card-body">
                  <div class="d-flex align-items-center justify-content-between">
                    <div>
                      <div class="text-muted small">Cancellations</div>
                      <div class="fw-bold">Cancellation rate by month</div>
                      <div class="text-muted small mt-1">Click to open report</div>
                    </div>
                    <i class="bi bi-x-circle fs-2"></i>
                  </div>
                </div>
              </div>
            </a>
          </div>

          <div class="col-md-3">
            <a class="text-decoration-none card-link-tile" href="{{ url_for('manager_report_page', rid=5) }}">
              <div class="card h-100 soft">
                <div class="card-body">
                  <div class="d-flex align-items-center justify-content-between">
                    <div>
                      <div class="text-muted small">Fleet usage</div>
                      <div class="fw-bold">Monthly activity per aircraft</div>
                      <div class="text-muted small mt-1">Click to open report</div>
                    </div>
                    <i class="bi bi-calendar3 fs-2"></i>
                  </div>
                </div>
              </div>
            </a>
          </div>

          <div class="col-md-3">
            <div class="card h-100 soft">
              <div class="card-body">
                <div class="d-flex align-items-center justify-content-between">
                  <div>
                    <div class="text-muted small">Avg. occupancy (completed)</div>
                    {% if stats.avg_occ_pct is not none %}
                      <div class="fs-3 fw-bold">{{ "%.5f"|format(stats.avg_occ_pct|float) }}</div>
                    {% else %}
                      <div class="fs-3 fw-bold">—</div>
                    {% endif %}
                  </div>
                  <div class="opacity-75">
                    <i class="bi bi-percent fs-2"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-9">
            <div class="card h-100 soft">
              <div class="card-body">
                <div class="fw-bold mb-2">Policy notes</div>
                <div class="text-muted d-flex flex-wrap align-items-center small">
                  <span><i class="bi bi-clock me-2"></i>Flight cancellation allowed up to <b>72h</b> before departure.</span>
                  <span class="mx-2">•</span>
                  <span><i class="bi bi-person-x me-2"></i>Customer order cancellation allowed up to <b>36h</b> before departure (5% fee).</span>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>


{% endblock %}
